% !TEX TS-program = lualatex
% !TEX encoding = UTF-8 Unicode

\documentclass[
  fontset = none,
  punct   = kaiming,
]{ctexart}
\usepackage{fontspec}
\usepackage{fancyhdr}
\usepackage{luatexja-ruby}
\usepackage{minted}
\usepackage[
  margin=1in,
  headheight=14pt,
]{geometry}
\usepackage[dvipsnames]{xcolor}
\usepackage[
  colorlinks,
  linkcolor = BrickRed,
  citecolor = Green,
  filecolor = Mulberry,
  urlcolor  = NavyBlue,
  menucolor = BrickRed,
  runcolor  = Mulberry,
]{hyperref}
\usepackage[
  backend  = biber,
  style    = caspervector,
  seconds,
  utf8,
  backref,
]{biblatex}
\usepackage[
  perpage,
  hang,
  flushmargin,
]{footmisc}
\usepackage{footnotebackref}
\usepackage{pifont}
\usepackage{graphicx}

\graphicspath{{Images/}}

\renewcommand{\emph}[1]{\textbf{#1}}

% å‚è€ƒæ–‡çŒ®
\addbibresource{ref.bib}

% ä»£ç å—
\renewcommand{\theFancyVerbLine}{%
  \ttfamily {%
    \oldstylenums{\arabic{FancyVerbLine}}
  }
}
\setminted{
  mathescape,
  linenos,
  frame    = lines,
  framesep = 2mm,
}

% å­—ä½“
\setmainfont{SF Pro Text}[
  ItalicFont = New York Small Regular Italic
]
\setsansfont{SF Pro Text}[
  ItalicFont = New York Small Regular Italic
]
\setCJKmainfont{Hiragino Sans GB}[
  ItalicFont = STKaiti,
]
\setCJKsansfont{Hiragino Sans GB}[
  ItalicFont = STKaiti,
]
\setCJKmonofont{Hiragino Sans GB}
\newcommand{\emoji}[1]{
  {\setmainfont{Apple Color Emoji}[Renderer=Harfbuzz]{#1}}
}

\newCJKfontfamily\song{Songti SC Light}[
  BoldFont   = Songti SC Bold,
  ItalicFont = STKaiti,
]

\setmonofont[
  ItalicFont     = JetBrains Mono Italic,
  BoldFont       = JetBrains Mono Bold,
  BoldItalicFont = JetBrains Mono Bold Italic,
  Contextuals    = Alternate,
]{JetBrains Mono}

\newfontfamily\lmmono{Latin Modern Mono}
\newCJKfontfamily\sans{Hiragino Sans GB}
\newCJKfontfamily\gothic{Hiragino Sans}
\newCJKfontfamily\mincho{Hiragino Mincho ProN}

% é“¾æ¥æ ·å¼
\urlstyle{same}
\let\oldurl\url
\renewcommand{\url}[1]{%
{\lmmono\oldurl{#1}}
}

% Footnote
%% Circled num
\renewcommand\thefootnote{
  \textcolor{black}\ding{\numexpr171+\value{footnote}}
}

%% Backref
\makeatletter
\LetLtxMacro{\BHFN@Old@footnotemark}{\@footnotemark}

\renewcommand*{\@footnotemark}{%
    \refstepcounter{BackrefHyperFootnoteCounter}%
    \xdef\BackrefFootnoteTag{bhfn:\theBackrefHyperFootnoteCounter}%
    \label{\BackrefFootnoteTag}%
    \BHFN@Old@footnotemark
}
\makeatother

% CTex è®¾ç½®
\ctexset{
  section={
    name={ç¬¬,èŠ‚},
    number=\arabic{section},
  }
}

% é¡µçœ‰
\fancyhf{}
\lhead{\textnormal{\rightmark}}
\rhead{--\ \thepage\ --}
\pagestyle{fancy}
\renewcommand\sectionmark[1]{%
  \markright{\CTEXifname{\CTEXthesection}{}\quad{}#1}}


% é¡µè„š
\fancyfoot[C]{\thepage}

\author{Colerar}
\date{\today}
\title{Lua\LaTeX{}é€šç”¨æ¨¡æ¿}

\begin{document}

% æ ‡é¢˜
\maketitle

% ç›®å½•
{
  \hypersetup{linkcolor=black}
  \tableofcontents
}

\newpage
\sans
\section{æ±‰è¯­}

æ±‰è¯­ï¼Œæ—¥éŸ©ç§°ä¸­å›½è¯­ï¼Œä¹¦å†™åˆå¯ç§°æ±‰æ–‡ã€ä¸­æ–‡ã€åæ–‡ã€å”æ–‡ï¼Œè¯­è¨€åˆç§°â€œåè¯­â€ã€å”è¯ã€ä¸­å›½è¯ç­‰ï¼Œ
æ±‰è¯­æ˜¯è”åˆå›½å®˜æ–¹è¯­è¨€ä¹‹ä¸€ï¼Œå±æ±‰è—è¯­ç³»çš„åˆ†æè¯­ï¼Œå…·æœ‰å£°è°ƒã€‚æ±‰è¯­çš„æ–‡å­—ç³»ç»Ÿâ€”â€”
æ±‰å­—æ˜¯ä¸€ç§æ„éŸ³æ–‡å­—ï¼Œè¡¨æ„çš„åŒæ—¶ä¹Ÿå…·ä¸€å®šçš„è¡¨éŸ³åŠŸèƒ½ã€‚æ±‰è¯­åŒ…å«ä¹¦é¢è¯­ä»¥åŠå£è¯­ä¸¤éƒ¨åˆ†ï¼Œ
å¤ä»£ä¹¦é¢æ±‰è¯­ç§°ä¸ºæ–‡è¨€æ–‡ï¼Œç°ä»£ä¹¦é¢æ±‰è¯­ä¸€èˆ¬æŒ‡ä½¿ç”¨ç°ä»£æ ‡å‡†æ±‰è¯­è¯­æ³•ã€è¯æ±‡çš„ä¸­æ–‡é€šè¡Œæ–‡ä½“
ï¼ˆåˆç§°ç™½è¯æ–‡ï¼‰ã€‚ç›®å‰å…¨çƒæœ‰å…­åˆ†ä¹‹ä¸€äººå£ä½¿ç”¨æ±‰è¯­ä½œä¸ºæ¯è¯­ã€‚æ±‰è¯­å£è¯­ä¸»è¦åˆ†ä¸ºå®˜è¯ã€å´è¯­ã€
é—½è¯­ã€ç²¤è¯­ã€æ¹˜è¯­ã€å®¢å®¶è¯­å’Œèµ£è¯­ç­‰ä¸ƒç§ï¼›å®ƒä»¬çš„è¯­è¨€å­¦å½’å±åœ¨è¥¿æ–¹è¯­è¨€å­¦ç•Œå­˜åœ¨äº‰è®®ï¼Œ
æˆ–è¢«è®¤ä¸ºæ˜¯ç‹¬ç«‹çš„è¯­è¨€ï¼Œæˆ–è¢«è®¤ä¸ºæ˜¯æ±‰è¯­æ–¹è¨€ã€‚


\newpage
\section[æ—¥æœ¬èª]{\gothic æ—¥æœ¬èª }

\mincho

\emph{\ltjruby{æ—¥æœ¬|èª}{ã«ã»ã‚“|ã”}}ã¯ã€ä¸»ã«æ—¥æœ¬å›½å†…ã‚„æ—¥æœ¬äººåŒå£«ã®é–“ã§ä½¿ã‚ã‚Œã¦ã„ã‚‹
è¨€èªã§ã‚ã‚‹ã€‚æ—¥æœ¬ã¯æ³•ä»¤ã«ã‚ˆã£ã¦å…¬ç”¨èªã‚’è¦å®šã—ã¦ã„ãªã„ãŒã€æ³•ä»¤ãã®ä»–ã®å…¬ç”¨æ–‡ã¯å…¨ã¦
æ—¥æœ¬èªã§è¨˜è¿°ã•ã‚Œã€å„ç¨®æ³•ä»¤ã«ãŠã„ã¦æ—¥æœ¬èªã‚’ç”¨ã„ã‚‹ã“ã¨ãŒå®šã‚ã‚‰ã‚Œã€å­¦æ ¡æ•™è‚²ã«ãŠã„ã¦ã¯
ã€Œå›½èªã€ã¨ã—ã¦æ•™ãˆã‚‰ã‚Œã‚‹ãªã©ã€äº‹å®Ÿä¸Šã€å”¯ä¸€ã®å…¬ç”¨èªã¨ãªã£ã¦ã„ã‚‹ã€‚


\newpage
\sans
\section{æ±‰å­—}

\emph{æ±‰å­—}ï¼Œåœ¨ä¸­å›½äº¦ç§°ä¸­æ–‡å­—ã€å›½å­—ã€å”å­—ã€æ–¹å—å­—ï¼Œæ˜¯æ±‰å­—æ–‡åŒ–åœˆå¹¿æ³›ä½¿ç”¨çš„ä¸€ç§æ–‡å­—ï¼Œ
æ˜¯ä¸–ç•Œä¸Šç‹¬æœ‰çš„ä¸€ç§æŒ‡ç¤ºä¼šæ„æ–‡å­—ä½“ç³»ï¼Œä¹Ÿæ˜¯ä¸–ç•Œä¸Šå”¯ä¸€ä»è¢«å¹¿æ³›ä½¿ç”¨å¹¶é«˜åº¦å‘å±•çš„è¯­ç´ æ–‡å­—ï¼Œ
ä¸ºä¸­å›½ä¸Šå¤æ—¶ä»£çš„åå¤æ—äººæ‰€å‘æ˜åˆ›åˆ¶ï¼Œå…¶å­—ä½“ä¹Ÿå†ç»è¿‡é•¿ä¹…æ”¹è¿›åŠæ¼”å˜ã€‚ç›®å‰ç¡®åˆ‡å†å²ï¼Œ
å¯è¿½æº¯è‡³çº¦å…¬å…ƒå‰1300å¹´å•†æœçš„ç”²éª¨æ–‡ã€ç±€æ–‡ã€é‡‘æ–‡ï¼Œå†åˆ°æ˜¥ç§‹æˆ˜å›½ä¸ç§¦æœçš„ç±€æ–‡ã€å°ç¯†ï¼Œ
å‘å±•è‡³æ±‰æœéš¶å˜ï¼Œäº§ç”Ÿéš¶ä¹¦ã€è‰ä¹¦ä»¥åŠæ¥·ä¹¦\footnote{ä»¥åŠæ´¾ç”Ÿçš„è¡Œä¹¦}ï¼Œè‡³å”ä»£æ¥·åŒ–ä¸ºä»Šæ—¥æ‰€ç”¨çš„
æ‰‹å†™å­—ä½“æ ‡å‡†â€”â€”æ­£æ¥·ï¼Œä¹Ÿæ˜¯ä»Šæ—¥æ™®éä½¿ç”¨çš„ç°ä»£æ±‰å­—ã€‚æ±‰å­—åœ¨å¤æ–‡ä¸­åªç§°â€œå­—â€ï¼Œå°‘æ•°æ°‘æ—ä¸ºåŒºåˆ«
è€Œç§°â€œæ±‰å­—â€ï¼ŒæŒ‡æ±‰äººä½¿ç”¨çš„æ–‡å­—ï¼Œåè€…ç§°æ³•åœ¨è¿‘ä»£æ‰å¼€å§‹é€šç”¨ã€‚

\newpage
\gothic
\section{ä»®å} \label{sec:kana}

\emph{\ltjruby{ä»®å}{ã‹ãª}}ã¨ã¯ã€æ¼¢å­—ã‚’ã‚‚ã¨ã«ã—ã¦æ—¥æœ¬ã§ä½œã‚‰ã‚ŒãŸæ–‡å­—ã®ã“ã¨ã€‚
ç¾åœ¨ä¸€èˆ¬ã«ã¯å¹³ä»®åã¨ç‰‡ä»®åã®ã“ã¨ã‚’æŒ‡ã™ã€‚è¡¨éŸ³æ–‡å­—ã®ä¸€ç¨®ã§ã‚ã‚Šã€åŸºæœ¬çš„ã«1å­—ãŒ1éŸ³ç¯€ã‚’
ã‚ã‚‰ã‚ã™éŸ³ç¯€æ–‡å­—ã«åˆ†é¡ã•ã‚Œã‚‹ã€‚æ¼¢å­—ã«å¯¾ã—ã¦\ltjruby{å’Œå­—}{ã‚ã˜}ã¨ã‚‚ã„ã†ã€‚ãŸã ã—å’Œå­—ã¯å’Œè£½æ¼¢å­—ã‚’
æ„å‘³ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚

\newpage
\sans
\section{ç« èŠ‚}

\subsection{å­èŠ‚}
\subsection{å­èŠ‚}
\subsubsection{å­å­èŠ‚}

\paragraph{æ®µè½} è¿™æ˜¯ä¸€ä¸ªæ®µè½ã€‚
\subparagraph{å­æ®µè½} è¿™æ˜¯ä¸€ä¸ªå­æ®µè½ã€‚

\newpage
\section{ä»£ç å—}

\begin{minted}{haskell}
import Control.Monad.State
fib n = flip evalState (0, 1) $ do
  forM [0..(n - 1)] $ \_ -> do
    (a, b) <- get
    put (b, a + b)
  (a, b) <- get
  return a
\end{minted}

ä¸‹æ–¹ä»£ç å—è¢«é«˜äº®äº†ï¼š

\begin{minted}[
  highlightlines={6-9}
]{kotlin}
suspend fun main(args: Array<String>) {
  when (val result = SorapointaMain().main(args)) {
      is CommandResult.Success -> {
          exitProcess(0)
      }
      is CommandResult.Error -> {
          println(result.userMessage)
          exitProcess(1)
      }
  }
}
\end{minted}


\newpage
\section{å›¾ç‰‡}

å›¾ \ref{fig:example} æ¥è‡ª Pexelsï¼Œä¸ºç‰ˆæƒ\copyright{}ä½œå“ï¼Œä¸æŒ‰ç…§æœ¬é¡¹ç›®æˆæƒåˆ†å‘ã€‚

\begin{figure}[htbp]
  \centering
  \includegraphics[scale=0.2]{pexels-1509534.jpg}
  \caption{å–è‡ª Pexels \url{https://www.pexels.com/photo/1509534/}}
  \label{fig:example}
\end{figure}

\begin{figure}[htbp]
\centering
\includegraphics[scale=0.2]{pexels-1509534.jpg}
\includegraphics[scale=0.2]{pexels-1509534.jpg}
\\[\smallskipamount]
\includegraphics[scale=0.2]{pexels-1509534.jpg}
\includegraphics[scale=0.2]{pexels-1509534.jpg}
\caption{å¤šä¸ªå›¾åƒå¹¶æ’}
\end{figure}


\newpage
\section{å…¶ä»–}

\sans

\begin{description}
  \item[é“¾æ¥] \url{https://www.example.com}
  \item[å¸¦æè¿°çš„é“¾æ¥] \href{https://www.ctan.org}{CTAN}
  \item[è·³è½¬é“¾æ¥]
    \hyperref[sec:kana]{ç‚¹æˆ‘è·³è½¬è‡³{\gothic{}ä»®å}}
  \item[è¡¨æƒ…ç¬¦å·] \emoji{ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜‚ğŸ‘ğŸ‘ª}
  \item[å‚è€ƒæ–‡çŒ®] Lorem ipsum \ldots \autocite{greenwade93}
  \item[ä¸­æ–‡å‚è€ƒæ–‡çŒ®] å¤æ´»å¸çš„é”»é€ æ–¹æ³•ã€‚ \autocite{bili_lex}
  \item[è„šæ³¨ä¸­çš„é“¾æ¥\footnotemark] å‚è§ä¸‹æ–¹
  \footnotetext{\href{https://example.org}{ç¤ºä¾‹}}
  \item[è„šæ³¨ä¸­çš„å¤šè¡Œæ–‡æœ¬\footnotemark] å‚è§ä¸‹æ–¹
  \footnotetext{%
    å¤šè¡Œæ–‡æœ¬ä¹Ÿèƒ½å¤Ÿè½»æ˜“å¯¹é½ã€‚\\
    è¿™ä¸ªåŠŸèƒ½ä½¿ç”¨ \texttt{footmisc} å®åŒ…ã€‚
  }
\end{description}

% å‚è€ƒæ–‡çŒ®
\printbibliography[heading=bibintoc]

\end{document}
